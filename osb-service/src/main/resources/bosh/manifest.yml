---
# https://bosh.io/docs/cli-v2.html#deployment-mgmt

name: osb-bosh-cassandra

releases:
  - name: osb-bosh-cassandra
    version: latest
  - name: osb-bosh-monitoring
    version: latest

update:
  canaries: 1
  max_in_flight: 2
  canary_watch_time: 1000-30000
  update_watch_time: 1000-30000

stemcells:
  - alias: default
    os: ubuntu-trusty
    version: latest

instance_groups:
  - name: cassandra
    instances: 3
    vm_type: small
    stemcell: default
    azs:
      - z1
    networks:
      - name: service
    persistent_disk_type: 10GB
    jobs:
      - name: cassandra
        release: osb-bosh-cassandra
      - name: node_exporter
        release: osb-bosh-monitoring
    properties:
      cluster_name: osb-cassandra
      cassandra_exporter:
        username: ((exporter_credentials.username))
        password: ((exporter_credentials.password))
      backup_agent:
        username: ((backup_credentials.username))
        password: ((backup_credentials.password))
      cassandra:
        cluster_name: osb-cassandra
        admin_users:
        - username: ((service_credentials.username))
          password: ((service_credentials.password))
          superuser: true
        - username: ((exporter_credentials.username))
          password: ((exporter_credentials.password))
          superuser: false
        backup_users:
        - username: ((backup_credentials.username))
          password: ((backup_credentials.password))
          superuser: true
        users:
        - username: ((default_credentials.username))
          password: ((default_credentials.password))
        databases:
        - name: cassandra_default
          class: SimpleStrategy
          durable_writes: true
          users:
            - ((default_credentials.username))